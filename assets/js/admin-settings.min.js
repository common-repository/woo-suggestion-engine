jQuery(document).ready((function(e){"use strict";e(".vi-ui.tabular.menu .item").vi_tab({history:!0,historyType:"hash"}),e(".vi-ui.accordion").addClass("viwse-accordion-init").villatheme_accordion("refresh"),e(".vi-ui.dropdown").addClass("viwse-dropdown-init").off().dropdown(),e(".vi-ui.checkbox").addClass("viwse-dropdown-init").off().checkbox(),e(document).on("change",'input[type="checkbox"]',(function(){e(this).prop("checked")?e(this).parent().find('input[type="hidden"]').val("1"):e(this).parent().find('input[type="hidden"]').val("")})),e(".search_no_result_suggestion").off().dropdown({onChange:function(s){s&&0!=s?e(".search_no_result_suggestion_enable").removeClass("viwse-hidden"):e(".search_no_result_suggestion_enable").addClass("viwse-hidden")}}),e(document.body).on("viwse_background_processing_status",(function(){e.ajax({url:"admin-ajax.php?action=viwse_background_processing_status",type:"POST",data:{nonce:e("#_viwse_nonce").val()},success:function(s){s.bg_processing&&setTimeout((function(){e(document.body).trigger("viwse_background_processing_status")}),5e3),s.onlyajax_visible?e(".viwse-search-ajax-button").removeClass("viwse-hidden"):e(".viwse-search-ajax-button").addClass("viwse-hidden"),s.bg_bt_text&&e(".viwse-background-render-button").data({bg_complete:s.bg_complete||"",bg_processing:s.bg_processing||""}).html(s.bg_bt_text),s.bg_text&&e(".viwse-background-render-status").html(s.bg_text),s.message&&e(document.body).trigger("villatheme_show_message",[s.status,[s.status,"background_settings"],s.message,!1,4500])},error:function(s){console.log(s),setTimeout((function(){e(document.body).trigger("viwse_background_processing_status")}),5e3)}})})),viwse_params.background_render_processing&&setTimeout((function(){e(document.body).trigger("viwse_background_processing_status")}),1e3),e(document).on("click",".viwse-background-render-button:not(.loading)",(function(){let s=e(this);e.ajax({url:"admin-ajax.php?action=viwse_background_settings",type:"POST",data:{build_data:s.data("bg_processing")?"":1,nonce:e("#_viwse_nonce").val()},beforeSend:function(){s.addClass("loading"),e(".viwse-button-save").attr("type","button")},success:function(i){s.removeClass("loading"),e(".viwse-button-save").attr("type","submit"),i.bg_processing&&setTimeout((function(){e(document.body).trigger("viwse_background_processing_status")}),5e3),i.onlyajax_visible?e(".viwse-search-ajax-button").removeClass("viwse-hidden"):e(".viwse-search-ajax-button").addClass("viwse-hidden"),i.bg_bt_text&&e(".viwse-background-render-button").data({bg_complete:i.bg_complete||"",bg_processing:i.bg_processing||""}).html(i.bg_bt_text),i.bg_text&&e(".viwse-background-render-status").html(i.bg_text),i.message&&e(document.body).trigger("villatheme_show_message",[i.status,[i.status,"background_settings"],i.message,!1,4500])},error:function(i){console.log(i),s.removeClass("loading"),e(".viwse-button-save").attr("type","submit")}})})),e(document).on("click",".viwse-search-ajax-button:not(.loading)",(function(){let s=e(this);if(!confirm(viwse_params.search_ajax_enable))return!1;e.ajax({url:"admin-ajax.php?action=viwse_search_ajax_enable",type:"POST",data:{search_ajax_enable:1,nonce:e("#_viwse_nonce").val()},beforeSend:function(){s.addClass("loading"),e(".viwse-button-save").attr("type","button")},success:function(i){s.removeClass("loading"),e(".viwse-button-save").attr("type","submit"),s.addClass("viwse-hidden"),i.bg_bt_text&&e(".viwse-background-render-button").removeClass("loading").data({bg_complete:"",bg_processing:""}).html(i.bg_bt_text),i.bg_text&&e(".viwse-background-render-status").html(i.bg_text),i.message&&e(document.body).trigger("villatheme_show_message",[i.message,[i.status,"search_ajax_enable"],"",!1,4500])},error:function(i){console.log(i),s.removeClass("loading"),e(".viwse-button-save").attr("type","submit")}})})),e(".viwse-search-result-position").sortable({connectWith:".viwse-search-result-position",handle:".viwse-search-result-item",placeholder:"viwse-placeholder",axis:"y"}),"viwse-suggestion"===viwse_params.current_page&&setTimeout((function(){jQuery(document).trigger("vib2bc-suggested_products-html")}),100),e(document).on("click",".viwse-suggestion-save",(function(){let s=e(this);e.ajax({url:"admin-ajax.php?action=viwse_save_suggestion",type:"POST",data:{suggested_products:JSON.parse(e("[name=suggested_products]").val()),suggest_related_product:e("#suggest_related_product").val(),nonce:e("#_viwse_nonce").val()},beforeSend:function(){s.addClass("loading")},success:function(i){s.removeClass("loading"),i.message&&e(document.body).trigger("villatheme_show_message",[i.message,[i.status,"edit-field"],"",!1,4500])},error:function(e){console.log(e),s.removeClass("loading")}})})),e(document).on("click",".viwse-shortcode-info",(function(s){navigator.clipboard.writeText(e(this).html()),e(document.body).trigger("villatheme_show_message",["Copied to Clipboard",["success"],"",!1,1e3])})),e(document).on("click",".viwse-button-create-shortcode",(function(){e(".viwse-popup-wrap-suggestion-info").length||e(document).trigger("viwse-suggestion-popup-html",[!0])})),e(document).on("click",".viwse-button-add-suggested-products, .viwse-suggestion-edit",(function(){e(this).closest(".viwse-suggestion-wrap").addClass("viwse-suggestion-wrap-editing"),e(".viwse-popup-wrap-suggestion-info").length||e(document).trigger("viwse-suggestion-popup-html")})),e(document).on("click",".viwse-suggestion-enable, .viwse-suggestion-disable",(function(s){e(this).closest(".viwse-suggestion-wrap").addClass("viwse-suggestion-wrap-editing");let i=JSON.parse(e("[name=suggested_products]").val()),t=e(this).closest(".viwse-suggestion-wrap").data("id"),o=i[t]||{};e(this).hasClass("viwse-suggestion-enable")?(o.enable="",e(".viwse-suggestion-wrap-editing").removeClass("viwse-suggestion-wrap-enable"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-disable").removeClass("viwse-hidden"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-enable").addClass("viwse-hidden")):(o.enable=1,e(".viwse-suggestion-wrap-editing").addClass("viwse-suggestion-wrap-enable"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-disable").addClass("viwse-hidden"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-enable").removeClass("viwse-hidden")),i[t]=o,e(".viwse-suggestion-wrap-editing").data("data",o).removeClass("viwse-suggestion-wrap-editing"),e("[name=suggested_products]").val(JSON.stringify(i))})),e(document).on("click",".viwse-suggestion-remove",(function(s){if(!confirm(viwse_params.remove_suggestion_title))return!1;let i=JSON.parse(e("[name=suggested_products]").val()),t=e(this).closest(".viwse-suggestion-wrap").data("id");i[t]&&delete i[t],e("[name=suggested_products]").val(JSON.stringify(i)),e(this).closest(".viwse-suggestion-wrap").remove()})),e(document).on("viwse-suggestion-popup-html",(function(s,i=!1){let t=e(".viwse-suggestion-wrap-editing").data("data")||{},o=JSON.parse(e("[name=products_info]").val()),a=JSON.parse(e("[name=categories_info]").val()),n=t.title??"",p=t.is_slide??"1",c=t.limit??20,l=t.cols??4,d=t.cols_mobile??2,u=t.suggestion??["top_searched"],v=t.include_products??[],r=t.include_categories??[],g=t.out_of_stock??1,w='<div class="viwse-popup-wrap viwse-popup-wrap-suggestion-info">';if(w+='<div class="viwse-popup"><div class="viwse-overlay viwse-overlay-loading"></div><div class="viwse-overlay"></div>',w+='<div class="viwse-popup-container-wrap"><span class="viwse-popup-close">&#43;</span>',w+='<div class="viwse-popup-container">',w+='<div class="viwse-popup-header-wrap">'+(i?viwse_params.popup_shortcode_header:viwse_params.popup_suggestion_header)+"</div>",w+='<div class="viwse-popup-content-wrap"><div class="viwse-popup-content-container">',!i){let s=e(".viwse-suggestion-wrap-editing").data("id")||(new Date).getTime(),i=t.enable??1;w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.enable_title}</div>`,w+='<div class="viwse-popup-content-value">',w+=`<input type="hidden" class="viwse-sug-id" value="${s}">`,w+='<div class="vi-ui checkbox toggle"><input type="hidden" value="'+i+'" name="enable">',w+='<input type="checkbox" '+(i?"checked":"")+"></div>",w+="</div></div></div>"}if(w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_title}</div>`,w+='<div class="viwse-popup-content-value">',w+=`<input type="text" name="title" class="viwse-shortcode-title" value="${n}" placeholder="You may also likeâ€¦">`,w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_suggestion}</div>`,w+='<div class="viwse-popup-content-value">',w+='<select class="viwse-shortcode-suggestion viwse-shortcode-suggestion-from vi-ui fluid dropdown viwse-shortcode-multi" name="suggestion" multiple>',e.each(viwse_params.shortcode_suggestion_arg,(function(e,s){w+=`<option value="${e}" >${s}</option>`})),w+="</select>",w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_include_products}</div>`,w+='<div class="viwse-popup-content-value"><div class="viwse-shortcode-suggestion-from">',w+='<select class="viwse-search-select2 viwse-shortcode-multi" name="include_products" data-type_select2="product" multiple>',e.each(v,(function(e,s){w+=`<option value="${s}" selected >${o[s]||s}</option>`})),w+="</select>",w+="</div></div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_include_categories}</div>`,w+='<div class="viwse-popup-content-value"><div class="viwse-shortcode-suggestion-from">',w+='<select class="viwse-search-select2 viwse-shortcode-multi" name="include_categories" data-type_select2="category" multiple>',e.each(r,(function(e,s){w+=`<option value="${s}" selected >${a[s]||s}</option>`})),w+="</select>",w+="</div></div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_out_of_stock}</div>`,w+='<div class="viwse-popup-content-value">',w+='<div class="vi-ui checkbox toggle"><input type="hidden" value="'+g+'" name="out_of_stock">',w+='<input type="checkbox" '+(g?"checked":"")+"></div>",w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_cols}</div>`,w+='<div class="viwse-popup-content-value viwse-shortcode-cols-wrap">',w+=`<div class="vi-ui right labeled input"><input type="number" name="cols" class="viwse-shortcode-cols" min="2" max="6" value="${l}"><label class="vi-ui label">${viwse_params.shortcode_cols_desktop}</label></div>`,w+=`<div class="vi-ui right labeled input"><input type="number" name="cols_mobile" class="viwse-shortcode-cols" min="1" max="3" value="${d}"><label class="vi-ui label">${viwse_params.shortcode_cols_mobile}</label></div>`,w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_limit}</div>`,w+='<div class="viwse-popup-content-value">',w+=`<input type="number" min="1" value="${c}" name="limit">`,w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.shortcode_is_slide}</div>`,w+='<div class="viwse-popup-content-value">',w+='<div class="vi-ui checkbox toggle"><input type="hidden" value="'+p+'" name="is_slide">',w+='<input type="checkbox" '+(p?"checked":"")+"></div>",w+="</div></div></div>",!i){let s=t.search_page_position??0,i=t.shop_page_position??0,o=t.cat_page_position??0,a=t.single_page_position??"after_summary",n=t.cart_page_position??0,p=t.checkout_page_position??0;w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.popup_sug_search_page}</div>`,w+='<div class="viwse-popup-content-value">',w+='<select class="viwse-sug-search-page-position viwse-sug-page-position vi-ui fluid dropdown" name="search_page_position">',e.each(viwse_params.popup_sug_loop_arg,(function(e,i){w+=`<option value="${e}" ${e===s?'selected="selected"':""}>${i}</option>`})),w+="</select>",w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.popup_sug_shop_page}</div>`,w+='<div class="viwse-popup-content-value">',w+='<select class="viwse-sug-shop-page-position viwse-sug-page-position vi-ui fluid dropdown" name="shop_page_position">',e.each(viwse_params.popup_sug_loop_arg,(function(e,s){w+=`<option value="${e}" ${e===i?'selected="selected"':""}>${s}</option>`})),w+="</select>",w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.popup_sug_cat_page}</div>`,w+='<div class="viwse-popup-content-value">',w+='<select class="viwse-sug-cat-page-position viwse-sug-page-position vi-ui fluid dropdown" name="cat_page_position">',e.each(viwse_params.popup_sug_loop_arg,(function(e,s){w+=`<option value="${e}" ${e===o?'selected="selected"':""}>${s}</option>`})),w+="</select>",w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.popup_sug_single_page}</div>`,w+='<div class="viwse-popup-content-value">',w+='<select class="viwse-sug-single-page-position viwse-sug-page-position vi-ui fluid dropdown" name="single_page_position">',e.each(viwse_params.popup_sug_single_arg,(function(e,s){w+=`<option value="${e}" ${e===a?'selected="selected"':""}>${s}</option>`})),w+="</select>",w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.popup_sug_cart_page}</div>`,w+='<div class="viwse-popup-content-value">',w+='<select class="viwse-sug-cart-page-position viwse-sug-page-position vi-ui fluid dropdown" name="cart_page_position">',e.each(viwse_params.popup_sug_cart_arg,(function(e,s){w+=`<option value="${e}" ${e===n?'selected="selected"':""}>${s}</option>`})),w+="</select>",w+="</div></div></div>",w+='<div class="viwse-popup-content">',w+='<div class="viwse-popup-content-horizontal viwse-popup-content-full-row">',w+=`<div class="viwse-popup-content-title">${viwse_params.popup_sug_checkout_page}</div>`,w+='<div class="viwse-popup-content-value">',w+='<select class="viwse-sug-checkout-page-position viwse-sug-page-position vi-ui fluid dropdown" name="checkout_page_position">',e.each(viwse_params.popup_sug_checkout_arg,(function(e,s){w+=`<option value="${e}" ${e===p?'selected="selected"':""}>${s}</option>`})),w+="</select>",w+="</div></div></div>"}w+="</div></div>",w+='<div class="viwse-popup-footer-wrap">',w+=i?'<span class="vi-ui button primary small viwse-popup-bt viwse-popup-bt-create-shortcode">Create shortcode</span>':'<span class="vi-ui button primary small viwse-popup-bt viwse-popup-bt-save-sug-info">Save</span>',w+="</div>",w+="</div></div></div></div>",w=e(w),w.find(".vi-ui.dropdown:not(.viwse-dropdown-init)").addClass("viwse-dropdown-init").dropdown(),w.find(".vi-ui.checkbox:not(.viwse-checkbox-init)").addClass("viwse-checkbox-init").checkbox(),setTimeout((function(s){e(s).find(".viwse-shortcode-suggestion").dropdown("set selected",u),s.find(".viwse-search-select2").each((function(){e(document).trigger("viwse-search-select2",[e(this)])}))}),100,w),e("body").append(w),setTimeout((function(){e(".viwse-popup-wrap-suggestion-info").removeClass("viwse-popup-wrap-hidden").addClass("viwse-popup-wrap-show")}),100),jQuery(document).trigger("viwse-disable-scroll")})),e(document).on("click",".viwse-popup-bt-save-sug-info",(function(){let s=[],i=!1,t=["include_products","include_categories","suggestion"],o=["search_page_position","shop_page_position","cat_page_position","single_page_position","cart_page_position","checkout_page_position"],a=e(this).closest(".viwse-popup-wrap"),n=JSON.parse(e("[name=suggested_products]").val());a.find(".viwse-warning-wrap").removeClass("viwse-warning-wrap");let p=a.find(".viwse-sug-id").val(),c=n[p]||{};if(a.find("input, select").each((function(a,n){let p=e(n).attr("name"),l=e(n).val();if(!p)return!0;if(t.includes(p)&&l.length&&(i=!0),o.includes(p)&&l&&"0"!==l)switch(p){case"search_page_position":s.push(`<span>Search results page: ${viwse_params.popup_sug_loop_arg[l]||l}</span>`);break;case"shop_page_position":s.push(`<span>Shop page: ${viwse_params.popup_sug_loop_arg[l]||l}</span>`);break;case"cat_page_position":s.push(`<span>Categories page: ${viwse_params.popup_sug_loop_arg[l]||l}</span>`);break;case"single_page_position":s.push(`<span>Single product page: ${viwse_params.popup_sug_single_arg[l]||l}</span>`);break;case"cart_page_position":s.push(`<span>Cart page: ${viwse_params.popup_sug_cart_arg[l]||l}</span>`);break;case"checkout_page_position":s.push(`<span>Checkout page: ${viwse_params.popup_sug_checkout_arg[l]||l}</span>`)}c[p]=l})),!i)return a.find(".viwse-shortcode-suggestion-from").addClass("viwse-warning-wrap"),e(document.body).trigger("villatheme_show_message",["The condition for the suggested products can not be empty. Please fill in at least one of the warning fields.",["error"],"",!1,4500]),!1;if(!s.length)return a.find(".viwse-sug-page-position ").addClass("viwse-warning-wrap"),e(document.body).trigger("villatheme_show_message",["Please choose at least one position to show products suggestion.",["error"],"",!1,4500]),!1;e(this).addClass("loading"),s=s.join("<br>");let l="Selected products";if(c.suggestion&&c.suggestion.length&&(l=[],e.each(c.suggestion,(function(e,s){l.push(viwse_params.shortcode_suggestion_arg[s]||s)})),l=l.join(", ")),n[p])e(".viwse-suggestion-wrap-editing").data("data",c),c.enable?(e(".viwse-suggestion-wrap-editing").addClass("viwse-suggestion-wrap-enable"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-disable").addClass("viwse-hidden"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-enable").removeClass("viwse-hidden")):(e(".viwse-suggestion-wrap-editing").removeClass("viwse-suggestion-wrap-enable"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-disable").removeClass("viwse-hidden"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-enable").addClass("viwse-hidden")),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-title").html(c.title||"-"),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-suggest_from").html(l),e(".viwse-suggestion-wrap-editing").find(".viwse-suggestion-position").html(s);else{let i=`<tr class="viwse-suggestion-wrap${c.enable?" viwse-suggestion-wrap-enable":""}">`;i+=`<td class="viwse-suggestion-title">${c.title||"-"}</td>`,i+=`<td class="viwse-suggestion-suggest_from">${l}</td>`,i+=`<td class="viwse-suggestion-position">${s}</td>`,i+='<td><div class="viwse-suggestion-action-wrap">',i+=`<span class="viwse-suggestion-edit" data-tooltip="${viwse_params.edit_title}"><i class="icon edit outline"></i></span>`,i+=`<span class="viwse-suggestion-remove" data-tooltip="${viwse_params.remove_title}"><i class="icon trash alternate outline"></i></span>`,i+=`<span class="viwse-suggestion-enable${c.enable?"":" viwse-hidden"}" data-tooltip="${viwse_params.disable_title}"><i class="dashicons dashicons-visibility"></i></span>`,i+=`<span class="viwse-suggestion-disable${c.enable?" viwse-hidden":""}" data-tooltip="${viwse_params.enable_title}"><i class="dashicons dashicons-hidden"></i></span>`,i+="</div></td>",i+="</tr>",i=e(i),i.data({id:p,data:c}),e(".viwse-suggestion-for-pages").append(i)}n[p]=c,e("[name=suggested_products]").val(JSON.stringify(n)),setTimeout((function(){e(".viwse-popup-close").trigger("click")}),100)})),e(document).on("click",".viwse-popup-bt-create-shortcode",(function(){let s="[viwse_suggestion ",i=[],t=!1;if(e(".viwse-warning-wrap").removeClass("viwse-warning-wrap"),e(this).closest(".viwse-popup-wrap-suggestion-info").find("input, select").each((function(s,o){let a=e(o).attr("name"),n=e(o).val();if(!a)return!0;(e(o).hasClass("viwse-shortcode-multi")||e(o).closest(".viwse-shortcode-multi").length)&&(n=n.join(",")),"include_products"!==a&&"include_categories"!==a&&"suggestion"!==a||!n||(t=!0),i.push(`${a}='${n}'`)})),s+=i.join(" ")+"]",!t)return e(".viwse-shortcode-suggestion-from").addClass("viwse-warning-wrap"),e(document.body).trigger("villatheme_show_message",["The condition for the suggested products can not be empty. Please fill in at least one of the warning fields.",["error"],"",!1,4500]),!1;navigator.clipboard.writeText(s),e(document.body).trigger("villatheme_show_message",["A new shortcode is created and copied to Clipboard",["success"],"",!1,1200])})),e(document).on("click",".viwse-popup-close, .viwse-overlay:not(.viwse-overlay-loading)",(function(s){jQuery(document).trigger("viwse-enable-scroll");let i=e(this).closest(".viwse-popup-wrap");i.hasClass("viwse-popup-wrap-show")&&i.removeClass("viwse-popup-wrap-show").addClass("viwse-popup-wrap-hidden"),e(".viwse-suggestion-wrap-editing").removeClass("viwse-suggestion-wrap-editing"),setTimeout((function(s){e(s).remove()}),100,i)})),e(document).on("viwse-search-select2",(function(s,i){let t="",o="";switch(i.data("type_select2")){case"product":t="Please fill in your product title",o="viwse_search_product";break;case"category":t="Please fill in your category title",o="viwse_search_category"}let a={closeOnSelect:!1,placeholder:t,cache:!0};o&&(a.minimumInputLength=2,a.escapeMarkup=function(e){return e},a.ajax={url:"admin-ajax.php?action="+o,dataType:"json",type:"GET",quietMillis:50,delay:250,data:function(e){return{keyword:e.term,nonce:jQuery("#_viwse_nonce").val()}},processResults:function(s){if(s.length){let i=e("viwse_search_product"===o?"[name=products_info]":"[name=categories_info]"),t=JSON.parse(i.val());e.each(s,(function(e,s){t[s.id]=s.text})),i.val(JSON.stringify(t))}return{results:s}},cache:!0}),i.select2(a)})),e(document).on("viwse-enable-scroll",(function(){let s=parseInt(e("html").css("top"));e("html").removeClass("viwse-noscroll"),window.scrollTo({top:-s,behavior:"instant"})})),e(document).on("viwse-disable-scroll",(function(){if(e(document).height()>e(window).height()){let s=e("html").scrollTop()?e("html").scrollTop():e("body").scrollTop();e("html").addClass("viwse-noscroll").css("top",-s)}})),e(document).on("vib2bc-suggested_products-html",(function(){let s=JSON.parse(e("[name=suggested_products]").val());if(!Object.keys(s).length)return!1;e.each(s,(function(s,i){let t="Selected products",o=[];i.suggestion&&i.suggestion.length&&(t=[],e.each(i.suggestion,(function(e,s){t.push(viwse_params.shortcode_suggestion_arg[s]||s)})),t=t.join(", ")),i.search_page_position&&"0"!==i.search_page_position&&o.push(`<span>Search results page: ${viwse_params.popup_sug_loop_arg[i.search_page_position]||i.search_page_position}</span>`),i.shop_page_position&&"0"!==i.shop_page_position&&o.push(`<span>Shop page: ${viwse_params.popup_sug_loop_arg[i.shop_page_position]||i.shop_page_position}</span>`),i.cat_page_position&&"0"!==i.cat_page_position&&o.push(`<span>Categories page: ${viwse_params.popup_sug_loop_arg[i.cat_page_position]||i.cat_page_position}</span>`),i.single_page_position&&"0"!==i.single_page_position&&o.push(`<span>Single product page: ${viwse_params.popup_sug_single_arg[i.single_page_position]||i.single_page_position}</span>`),i.cart_page_position&&"0"!==i.cart_page_position&&o.push(`<span>Cart page: ${viwse_params.popup_sug_cart_arg[i.cart_page_position]||i.cart_page_position}</span>`),i.checkout_page_position&&"0"!==i.checkout_page_position&&o.push(`<span>Checkout page: ${viwse_params.popup_sug_checkout_arg[i.checkout_page_position]||i.checkout_page_position}</span>`),o=o.join("<br>");let a=`<tr class="viwse-suggestion-wrap${i.enable?" viwse-suggestion-wrap-enable":""}">`;a+=`<td class="viwse-suggestion-title">${i.title||"-"}</td>`,a+=`<td class="viwse-suggestion-suggest_from">${t}</td>`,a+=`<td class="viwse-suggestion-position">${o}</td>`,a+='<td><div class="viwse-suggestion-action-wrap">',a+=`<span class="viwse-suggestion-edit" data-tooltip="${viwse_params.edit_title}"><i class="icon edit outline"></i></span>`,a+=`<span class="viwse-suggestion-remove" data-tooltip="${viwse_params.remove_title}"><i class="icon trash alternate outline"></i></span>`,a+=`<span class="viwse-suggestion-enable${i.enable?"":" viwse-hidden"}" data-tooltip="${viwse_params.disable_title}"><i class="dashicons dashicons-visibility"></i></span>`,a+=`<span class="viwse-suggestion-disable${i.enable?" viwse-hidden":""}" data-tooltip="${viwse_params.enable_title}"><i class="dashicons dashicons-hidden"></i></span>`,a+="</div></td>",a+="</tr>",a=e(a),a.data({id:s,data:i}),e(".viwse-suggestion-for-pages").append(a)}))}))}));